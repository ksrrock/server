SET GLOBAL innodb_file_format = `Barracuda`;
SET GLOBAL innodb_file_per_table = ON;
SET GLOBAL innodb_encrypt_tables = OFF;
SET GLOBAL innodb_default_encryption_key_id = 1;
create table t1 (a int not null primary key) engine=InnoDB;
SET GLOBAL innodb_default_encryption_key_id = 999;
ERROR 42000: Variable 'innodb_default_encryption_key_id' can't be set to the value of '999'
SHOW WARNINGS;
Level	Code	Message
Warning	1210	InnoDB: innodb_default_encryption_key_id=999 not available in encryption plugin
Error	1231	Variable 'innodb_default_encryption_key_id' can't be set to the value of '999'
SET GLOBAL innodb_default_encryption_key_id = 4;
SET GLOBAL innodb_encryption_threads = 4;
SET GLOBAL innodb_encrypt_tables = ON;
SELECT NAME,CURRENT_KEY_ID,MIN_KEY_VERSION FROM INFORMATION_SCHEMA.INNODB_TABLESPACES_ENCRYPTION WHERE MIN_KEY_VERSION = 0 ORDER BY NAME;
NAME	CURRENT_KEY_ID	MIN_KEY_VERSION
SELECT NAME,CURRENT_KEY_ID,MIN_KEY_VERSION FROM INFORMATION_SCHEMA.INNODB_TABLESPACES_ENCRYPTION WHERE MIN_KEY_VERSION <> 0 ORDER BY NAME;
NAME	CURRENT_KEY_ID	MIN_KEY_VERSION
./ibdata1	4	1
mysql/innodb_index_stats	4	1
mysql/innodb_table_stats	4	1
test/t1	4	1
# Success!
DROP TABLE t1;
SET GLOBAL innodb_encryption_threads = DEFAULT;
SET GLOBAL innodb_encrypt_tables = DEFAULT;
SET GLOBAL innodb_file_format = DEFAULT;
SET GLOBAL innodb_file_per_table = DEFAULT;
SET GLOBAL innodb_default_encryption_key_id = DEFAULT;
